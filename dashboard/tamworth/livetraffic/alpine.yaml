---
type: entities
card_mod:
  style:
    fold-entity-row$: |
      ha-icon {
        color: rgb(var(--rgb-disabled-color));
        margin-right: 24px;
      }
    hui-section-row $: |
      .divider { display: none; }
    .: |
      .card-content {
        padding: 0;
      }
entities:
  - type: custom:fold-entity-row
    head:
      type: custom:mushroom-template-card
      entity: ""
      primary: Live Traffic - Alpine
      secondary: |
        {{states('sensor.getdata_livetrafficnsw_alpine')}} Incidents
      icon: mdi:snowflake-alert
      icon_color: >
        {% if states('sensor.getdata_livetrafficnsw_alpine') == "0" %} grey
        {%else%} red {% endif %}
      fill_container: true
      multiline_secondary: false
      card_mod:
        style: |
          ha-card {
            background: none;
            border: 0;
            box-shadow: none;
          }
    padding: 0
    entities:
      - type: custom:hui-element
        card_type: markdown
        card_mod:
          style: |
            ha-card.type-markdown {
              box-shadow: none;
              border-top: 1px groove var(--divider-color);
              overflow-y: scroll;
              height: 300px;
            }
            ha-card.type-markdown::-webkit-scrollbar { width: 12px; }
        content: >
          {% if states('sensor.getdata_livetrafficnsw_alpine') == "0" %}
          No Incidents Recorded
          {%- else %}
          {%- for item in state_attr('sensor.getdata_livetrafficnsw_alpine', 'data')|sort(attribute='starttime') %}

          **{{ item.incidenttype }}: {{ item.displayname }}, {{ item.road }} {{ item.suburb}} ({{item.dist_km}}km away)**
          {{ item.advice }}; {{ item.additionalinfo }}; {{item.periods }}
          Start: {{ item.starttime | int | timestamp_custom ('%H:%M, %d/%m/%Y') }}, End: {%- if item.endtime == 0 %} None Recorded {%- else %} {{ item.endtime | int | timestamp_custom ('%H:%M, %d/%m/%Y') }}{% endif %}
          Last Update: {{ item.lastupdatetime | int | timestamp_custom ('%H:%M, %d/%m/%Y') }}

          {% endfor %}
          {%- endif %}
