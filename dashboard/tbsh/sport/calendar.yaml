---
type: custom:auto-entities
unique: true
show_empty: true
card:
  type: custom:layout-card
  layout_type: grid
  layout:
    grid-template-columns: auto auto auto auto
    grid-template-rows: auto
    mediaquery:
      "(max-width: 500px)":
        grid-template-columns: auto
      "(max-width: 1370px)":
        grid-template-columns: auto auto
filter:
  template: >
    {% for s in expand(states.group.upcomingsport_withevents)|map(attribute='entity_id')|list|sort -%}
      {{
        {
          "type": "custom:mushroom-template-card",
          "entity": s,
          "primary": "{{ state_attr(entity, 'friendly_name') | replace('[Upcoming Sport] ', '') }}",
          "secondary": "{{ iif(state_attr(entity, 'nextevent_time') == 'No Event Scheduled', 'No Event Scheduled', state_attr(entity, 'nextevent_desc') + ' ' + state_attr(entity, 'nextevent_time')) }}\n{{ iif(state_attr(entity, 'afterevent_time') == 'No Event Scheduled', 'No Event Scheduled', state_attr(entity, 'afterevent_desc') + ' ' + state_attr(entity, 'afterevent_time')) }}",
          "fill_container": true,
          "multiline_secondary": true,
          "badge_icon": "{%- if is_state_attr(entity, 'nextevent_timeto', 0) %} mdi:clock {%- endif %}",
          "badge_color": "green",
          "icon": "{{ state_attr(entity, 'icon') }}",
          "card_mod": {
            "style": {
              ".": "ha-card:before {\n  content: '';\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  right: 5px;\n  background: url( {{ state_attr(config.entity, 'entity_picture') }} ) center no-repeat, linear-gradient(to left, transparent, var(--background-color) 50%);\n  background-repeat: no-repeat;\n  background-size: auto 100%, cover;\n  background-position: right;\n  background-blend-mode: saturation;\n  filter: opacity(0.25);\n  }\nha-card {\n  background-color: var(--card-background-color);\n  box-shadow: none;\n}\n"
            }
          },
          "tap_action": {
            "action": "fire-dom-event",
            "browser_mod": {
              "service": "browser_mod.popup",
                "hide_header": false,
                "data": {
                  "title": "Calendar",
                  "content": {
                    "type": "custom:layout-card",
                    "layout_type": "custom:grid-layout",
                    "layout": {
                      "margin": "0px"
                    },
                    "cards": [
                      {
                          "type": "custom:atomic-calendar-revive",
                          "entities": [
                            {
                              "entity": "calendar.ical_" + s | replace("sensor.upcoming_sport_","")
                            }
                          ],
                          "maxDaysToShow": 365,
                          "enableModeChange": true,
                          "showWeekDay": true,
                          "firstDayOfWeek": 1,
                          "refreshInterval": 600,
                          "showMonth": true,
                          "showCurrentEventLine": false,
                          "showDate": false,
                          "sortByStartTime": true,
                          "showDeclined": true,
                          "showRelativeTime": true,
                          "showMultiDay": true,
                          "showMultiDayEventParts": false,
                          "hideDuplicates": true,
                          "showLastCalendarWeek": false,
                          "calShowDescription": true,
                          "disableCalLink": false,
                          "disableCalLocationLink": false,
                          "disableCalEventLink": false,
                          "dimFinishedEvents": true,
                          "showProgressBar": false,
                          "showDescription": false
                      }
                      ]
                    }
                }
              }
          }
        }
      }},
    {%- endfor %}
options: null
sort:
  method: friendly_name
card_mod:
  style:
    fold-entity-row$: |
      ha-icon {
        background: none !important;
        margin-right: 24px !important;
        --toggle-icon-width: 21px !important;
        color: rgb(var(--rgb-disabled-color));
      }
      ha-icon:active {
        animation: rotate 200ms linear forwards;
      }
      @keyframes rotate {
        100% { transform: rotate(180deg); }
      }
    .: |
      ha-card {
        background: none;
        box-shadow: none;
      }
      .card-content {
        padding: 0;
      }
      * {
        margin: 0 !important;
      }
