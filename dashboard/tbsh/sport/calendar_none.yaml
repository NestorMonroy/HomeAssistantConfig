---
type: custom:auto-entities
unique: true
show_empty: true
card:
  type: entities
  show_header_toggle: false
  card_mod:
    style: |
      ha-card {
        background: none;
        box-shadow: none;
      }
      .card-content {
        padding: 0 !important
      }
filter:
  template: >
    {% for s in states|selectattr('entity_id','search','sensor.sport_') |
    selectattr("attributes.nextevent", "search", "(Scheduled|None)") |
    sort(attribute="attributes.friendly_name")  -%}
      {{
        {
          "type": "custom:fold-entity-row",
          "head": {
            "type": "custom:mushroom-template-card",
            "primary": "{{ state_attr(entity, \"friendly_name\") }}",
            "multiline_secondary": true,
            "secondary": "{% if states(entity) == \"Nothing Scheduled\" %} {{ state_attr(entity, \"nextevent\") }} {% else %} {{ state_attr(entity, \"nextevent\") }} ({{ state_attr(entity, \"nexttime\") }})\n{{ state_attr(entity, \"nexteventafter\") }} {% endif %}",
            "entity": s.entity_id,
            "badge_icon": "{%- if is_state_attr(entity, 'nexttime', 'On Now!') %} mdi:clock {%- endif %}",
            "icon": "{{ state_attr(entity, \"icon\") }}",
            "icon_color": "{%- if is_state_attr(entity, 'nexttime', 'On Now!') %} green {% elif states(entity) == \"Nothing Scheduled\" %} grey {% else %} orange {%- endif %}",
            "badge_color": "green",
            "tap_action": "none",
            "card_mod": {
              "style": {
                "mushroom-state-info$": ".primary {\n  font-size: 14px !important;\n  white-space: normal !important;\n}\n.secondary {\n  font-size: 13px !important;\n}\n",
                ".": "ha-card:before {\n  content: \"\";\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  right: 5px;\n  background: url( {{ state_attr(config.entity, \"entity_picture\") }} ) center no-repeat, linear-gradient(to left, transparent, var(--background-color) 50%);\n  background-repeat: no-repeat;\n  background-size: auto 100%, cover;\n  background-position: right;\n  background-blend-mode: saturation;\n  filter: opacity(0.25);\n}\nha-card {\n  background: none;\n  box-shadow: none;\n}\n"
              }
            }
          },
          "padding": 0,
          "entities": [
            {
              "type": "custom:atomic-calendar-revive",
              "maxDaysToShow": 365,
              "enableModeChange": true,
              "showWeekDay": true,
              "firstDayOfWeek": 1,
              "refreshInterval": 600,
              "showMonth": true,
              "showCurrentEventLine": false,
              "showDate": false,
              "sortByStartTime": true,
              "showDeclined": true,
              "showRelativeTime": true,
              "showMultiDay": true,
              "showMultiDayEventParts": false,
              "hideDuplicates": true,
              "showLastCalendarWeek": false,
              "calShowDescription": true,
              "disableCalLink": false,
              "disableCalLocationLink": false,
              "disableCalEventLink": false,
              "dimFinishedEvents": true,
              "showProgressBar": false,
              "showDescription": false,
              "entities": [
                {
                  "entity": "calendar.ical_" + s.entity_id | replace("sensor.sport_","")
                }
              ],
              "card_mod": {
                "style": "ha-card {\n  background: none;\n  box-shadow: none;\n}\n"
              }
            }
          ]
        }
      }},
    {%- endfor %}
options: null
sort:
  method: friendly_name
card_mod:
  style:
    fold-entity-row$: |
      ha-icon {
        background: none !important;
        margin-right: 24px !important;
        --toggle-icon-width: 21px !important;
        color: rgb(var(--rgb-disabled-color));
      }
      ha-icon:active {
        animation: rotate 200ms linear forwards;
      }
      @keyframes rotate {
        100% { transform: rotate(180deg); }
      }
    .: |
      ha-card {
        background: none;
        box-shadow: none;
      }
      .card-content {
        padding: 0;
      }
      * {
        margin: 0 !important;
      }
