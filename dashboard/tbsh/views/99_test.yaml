---
theme: noctis
title: Testing
path: testing
icon: mdi:directions
type: custom:grid-layout
layout:
  margin: 0
  padding: 0
  grid-gap: 0px
  grid-template-columns: 1fr
  grid-template-rows: repeat(6, min-content)
  grid-template-areas: |
    "top_nav"
    "content"
    "otherActions"
    "footer"
    "mediaPlayer"
    "sidebar"
  mediaquery:
    "(min-width: 880px)":
      grid-template-columns: 285px auto
      grid-template-rows: 50px fit-content(100%) 70px 120px 64px
      grid-template-areas: |
        "sidebar    top_nav"
        "sidebar    content"
        "sidebar    otherActions"
        "sidebar    mediaPlayer"
        "footer     footer"
cards:
  - type: "horizontal-stack"
    view_layout:
      grid-area: top_nav
    cards:
      - type: "custom:button-card"
        template: top_nav

  - type: "vertical-stack"
    view_layout:
      grid-area: sidebar
    cards:
      - type: "custom:button-card"
        template: sidebar

  - type: "custom:layout-card"
    layout_type: "custom:grid-layout"
    layout:
      grid-template-columns: 1fr
      grid-template-rows: repeat(6, auto)
      grid-template-areas: |
        "c1"
        "c2"
        "c3"
        "c4"
        "c5"
        "c6"
      # margin: 0
      grid-gap: 2px
      height: 100%
      mediaquery:
        "(min-width: 880px)":
          grid-template-columns: 1fr 1fr 1fr
          grid-template-rows: min-content min-content
          grid-template-areas: |
            "c1 c2 c3"
            "c4 c5 c6"

    view_layout:
      grid-area: content
    cards:
      - type: "vertical-stack"
        view_layout:
          grid-area: c1
        cards:
          - type: "custom:button-card"
            name: "Living Room"
            template:
              - section_title

      - type: "vertical-stack"
        view_layout:
          grid-area: c2
        cards:
          - type: "custom:button-card"
            name: "Flight Tracker"
            template:
              - section_title
          - !include ../flighttracker/flightsoverhead.yaml
          - !include ../flighttracker/closestplane.yaml
          - !include ../flighttracker/planeofinterest.yaml

      - type: "vertical-stack"
        view_layout:
          grid-area: c3
        cards:
          - type: "custom:button-card"
            name: "Living Room"
            template:
              - section_title

      - type: "vertical-stack"
        view_layout:
          grid-area: c4
        cards:
          - type: "custom:button-card"
            name: "Network"
            template:
              - section_title
          - square: false
            columns: 1
            type: grid
            cards:
              - type: custom:decluttering-card
                template: mushroom_entity_graph
                variables:
                  - entity: sensor.unifi_gateway_wan_uptimeavail_stats
                  - colour: "#8694E7"
                  - title: Internet Uptime
                  - icon: mdi:timelapse
                  - line_width: 3

              - type: custom:decluttering-card
                template: mushroom_entity_graph
                variables:
                  - entity: sensor.unifi_networkstats_connected_devices
                  - colour: "#8694E7"
                  - title: Network Connected Devices
                  - icon: mdi:download-network
                  - line_width: 3

              - type: custom:decluttering-card
                template: mushroom_entity_graph
                variables:
                  - entity: sensor.speedtest_download
                  - colour: "#8694E7"
                  - title: Download
                  - icon: mdi:download-network
                  - line_width: 3

              - type: custom:decluttering-card
                template: mushroom_entity_graph
                variables:
                  - entity: sensor.speedtest_upload
                  - colour: "#8694E7"
                  - title: Upload
                  - icon: mdi:upload-network
                  - line_width: 3

              - type: custom:decluttering-card
                template: mushroom_entity_graph
                variables:
                  - entity: sensor.speedtest_ping
                  - colour: "#8694E7"
                  - title: Ping
                  - icon: mdi:web
                  - line_width: 3

      - type: "vertical-stack"
        view_layout:
          grid-area: c5
        cards:
          - type: "custom:button-card"
            name: "Upcoming Sport"
            template:
              - section_title
          - square: false
            columns: 2
            type: grid
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.stats_sport_upcoming_today
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                secondary_info: name
                primary_info: state
                name: Today
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.stats_sport_upcoming_thisweek
                name: This Week
                fill_container: false
                icon_color: yellow
                tap_action:
                  action: none
                hold_action:
                  action: none
                double_tap_action:
                  action: none
                primary_info: state
                secondary_info: name
          - type: custom:auto-entities
            sort:
              method: attribute
              attribute: sortorder
            card_param: cards
            filter:
              template: >-
                {% for s in states|selectattr('entity_id','search','sensor.sport_') |
                selectattr("attributes.sortorder", "<=", 7) |
                sort(attribute="attributes.sortorder")  -%}
                  {{
                    {
                      "type": "custom:mushroom-template-card",
                      "primary": "{{ state_attr(entity, \"friendly_name\") }}",
                      "multiline_secondary": true,
                      "secondary": "{{ state_attr(entity, \"nextevent\") }} ({{ state_attr(entity, \"nexttime\") }})\n{{ state_attr(entity, \"nexteventafter\") }}",
                      "entity": s.entity_id,
                      "badge_icon": "{%- if is_state_attr(entity, 'nexttime', 'On Now!') %} mdi:clock {%- endif %}",
                      "icon": "{{ state_attr(entity, \"icon\") }}",
                      "badge_color": "green",
                      "tap_action": "none",
                      "card_mod": {
                        "style": {
                          "mushroom-state-info$": ".primary {\n  font-size: 16px !important;\n  white-space: normal !important;\n}\n.secondary {\n  font-size: 15px !important;\n}\n",
                          ".": "ha-card:before {\n  content: \"\";\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  right: 5px;\n  background: url( {{ state_attr(config.entity, \"entity_picture\") }} ) center no-repeat, linear-gradient(to left, transparent, var(--background-color) 50%);\n  background-repeat: no-repeat;\n  background-size: auto 100%, cover;\n  background-position: right;\n  background-blend-mode: saturation;\n  filter: opacity(0.25);\n}\nha-card {\n  background: none;\n  box-shadow: none;\n}\n"
                        }
                      }
                    }
                  }},
                {%- endfor %}
            show_empty: false
            card:
              type: custom:swipe-card
              parameters:
                direction: vertical
                autoHeight: true
                height: 112
                effect: cube
                autoplay:
                  delay: 2000
                cubeEffect:
                  - slideShadows: false

      - type: "vertical-stack"
        view_layout:
          grid-area: c6
        cards:
          - type: "custom:button-card"
            name: "Media"
            template:
              - section_title
          - square: false
            type: grid
            cards:
              - type: custom:decluttering-card
                template: frontpage_plex_unwatched_tv
              - type: custom:decluttering-card
                template: frontpage_sonarr
              - type: custom:decluttering-card
                template: frontpage_plex_unwatched_movies
              - type: custom:decluttering-card
                template: frontpage_radarr
            columns: 2

  - type: "custom:mod-card"
    style: |
      ha-card {
        border-radius: 0px;
        padding: 12px 8px;
        margin: 0px;
        height: auto;
      }
    view_layout:
      grid-area: otherActions
    card:
      type: "horizontal-stack"
      cards:
        - type: "custom:button-card"
          icon: mdi:home-assistant
          name: "Home Assistant"
          template:
            - popup_button
        - type: "custom:button-card"
          entity: sensor.stats_docker
          icon: mdi:docker
          name: Docker
          variables:
            notification: >
              [[[
                return parseInt(entity?.attributes.containers_stopped);
              ]]]
          template:
            - popup_button
        - type: "custom:button-card"
          icon: mdi:tablet
          name: "Home Hub"
          variables:
            notification: >
              [[[
                let id = states['binary_sensor.home_hub_plugged_in'];
                if (id) return id.state === 'off';
              ]]]
          template:
            - popup_button
        - type: "custom:button-card"
          icon: mdi:history
          name: "History"
          template:
            - popup_button
        - type: "custom:button-card"
          icon: mdi:server
          name: "Proxmox"
          template:
            - popup_button
        - type: "custom:button-card"
          icon: mdi:update
          name: "Updates"
          entity: sensor.template_updates
          variables:
            notification: >
              [[[
                return parseInt(entity?.state);
              ]]]
          template:
            - popup_button
        - type: "custom:button-card"
          icon: mdi:router-wireless-settings
          name: "Router"
          template:
            - popup_button

  - type: "vertical-stack"
    view_layout:
      grid-area: mediaPlayer
    cards:
      - type: "custom:button-card"
        entity: media_player.currently_playing
        variables:
          media_icon: sensor.active_media_players
          media_source: sensor.active_media_players
          entity_picture: sensor.active_media_players
        template:
          - conditional_media
      # - type: conditional
      #   conditions:
      #     - entity: select.conditional_media
      #       state: Living Room Apple TV
      #   card:
      #     type: "custom:button-card"
      #     entity: media_player.living_room_apple_tv
      #     variables:
      #       media_icon: sensor.active_media_players
      #       media_source: sensor.active_media_players
      #       entity_picture: sensor.active_media_players
      #     template:
      #       - conditional_media
      # - type: conditional
      #   conditions:
      #     - entity: select.conditional_media
      #       state: Living Room HomePod mini
      #   card:
      #     type: "custom:button-card"
      #     entity: media_player.living_room_homepod_mini
      #     variables:
      #       media_icon: sensor.active_media_players
      #       media_source: sensor.active_media_players
      #       entity_picture: sensor.active_media_players
      #     template:
      #       - conditional_media
      # - type: conditional
      #   conditions:
      #     - entity: select.conditional_media
      #       state: Kitchen HomePod mini
      #   card:
      #     type: "custom:button-card"
      #     entity: media_player.kitchen_homepod_mini
      #     variables:
      #       media_icon: sensor.active_media_players
      #       media_source: sensor.active_media_players
      #       entity_picture: sensor.active_media_players
      #     template:
      #       - conditional_media

  - type: "horizontal-stack"
    view_layout:
      grid-area: footer
    cards:
      - type: "custom:button-card"
        entity: sensor.template_footer
        template: footer
