---
type: custom:stack-in-card
cards:
  - type: custom:mushroom-template-card
    primary: FlightRadar24
    icon: mdi:airplane
    icon_color: blue
    card_mod:
      style: |
        ha-card {
          box-shadow: none !important;
        }
  - type: entities
    card_mod:
      style: |
        #states {
          padding-top: 0 !important;
        }
        #states > * {
          margin: 0 !important;
        }
    entities:
      - entity: sensor.adsb_fr24_feeder_radar_code
        type: custom:multiple-entity-row
        name: FR24 Radar Code
      - entity: sensor.adsb_fr24_feeder_version
        type: custom:multiple-entity-row
        name: FR24 Version
  - square: false
    type: grid
    columns: 1
    cards:
      - type: custom:stack-in-card
        mode: vertical
        keep:
          margin: false
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: minmax(0, 1fr)
              grid-template-rows: auto
              grid-template-areas: |
                "a b"
                "c c"
            cards:
              - type: custom:mushroom-template-card
                view_layout:
                  grid-area: a
                entity: binary_sensor.adsb_fr24_feeder_link_connected
                primary: Link Connectivity
                secondary: |-
                  {% if is_state(config.entity, 'on') %}
                    connected
                  {% elif is_state(config.entity, 'off') %}
                    disconnected
                  {% else %}
                    unknown
                  {% endif %}
                icon: mdi:airplane-alert
                icon_color: |-
                  {% if is_state(config.entity, 'on') %}
                    #45C669
                  {% elif is_state(config.entity, 'off') %}
                    #C66445
                  {% else %}
                    disabled
                  {% endif %}
                fill_container: true
                tap_action:
                  action: more-info
                double_tap_action:
                  action: none
                hold_action:
                  action: none
                card_mod:
                  style: |-
                    {% if is_state(config.entity, 'on') %}
                      ha-card {
                        border: none;
                        box-shadow: none;
                        padding: 0px !important;
                        --primary-text-color: #45C669;
                        --secondary-text-color: #45C669;
                        }
                    {% elif is_state(config.entity, 'off') %}
                      ha-card {
                        border: none;
                        box-shadow: none;
                        padding: 0px !important;
                        --primary-text-color: #C66445;
                        --secondary-text-color: #C66445;
                      }
                    {% endif %}
                    {% if is_state(config.entity, 'off') %}
                      ha-state-icon {
                        animation: pulse 2s ease-in-out infinite;
                      }
                    {% endif %}
              - type: custom:uptime-card
                view_layout:
                  grid-area: c
                entity: binary_sensor.adsb_fr24_feeder_link_connected
                hours_to_show: 24
                update_interval: 30
                severity: 10
                bar:
                  height: 36
                  amount: 36
                tap_action:
                  action: none
                init:
                  animation: slide
                  slide duration: 0.5
                show:
                  header: false
                  title: false
                  icon: false
                  average: false
                  footer: false
                  timeline: true
                  status: false
                card_mod:
                  style: |-
                    ha-card {
                      border: none;
                      box-shadow: none;
                      margin-top: -5px ;
                      padding-top: 0px !important;
                      padding-bottom: 0px !important;
                    }
                    .timeline {
                      margin-top: 0px;
                      padding-top: 0px !important;
                      padding-left: 4px ;
                      padding-right: 4px;
                      }
      - type: custom:stack-in-card
        mode: vertical
        keep:
          margin: false
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: minmax(0, 1fr)
              grid-template-rows: auto
              grid-template-areas: |
                "a b"
                "c c"
            cards:
              - type: custom:mushroom-template-card
                view_layout:
                  grid-area: a
                entity: binary_sensor.adsb_fr24_feeder_receiver_connected
                primary: Reciever Connectivity
                secondary: |-
                  {% if is_state(config.entity, 'on') %}
                    connected
                  {% elif is_state(config.entity, 'off') %}
                    disconnected
                  {% else %}
                    unknown
                  {% endif %}
                icon: mdi:airplane-alert
                icon_color: |-
                  {% if is_state(config.entity, 'on') %}
                    #45C669
                  {% elif is_state(config.entity, 'off') %}
                    #C66445
                  {% else %}
                    disabled
                  {% endif %}
                fill_container: true
                tap_action:
                  action: more-info
                double_tap_action:
                  action: none
                hold_action:
                  action: none
                card_mod:
                  style: |-
                    {% if is_state(config.entity, 'on') %}
                      ha-card {
                        border: none;
                        box-shadow: none;
                        padding: 0px !important;
                        --primary-text-color: #45C669;
                        --secondary-text-color: #45C669;
                        }
                    {% elif is_state(config.entity, 'off') %}
                      ha-card {
                        border: none;
                        box-shadow: none;
                        padding: 0px !important;
                        --primary-text-color: #C66445;
                        --secondary-text-color: #C66445;
                      }
                    {% endif %}
                    {% if is_state(config.entity, 'off') %}
                      ha-state-icon {
                        animation: pulse 2s ease-in-out infinite;
                      }
                    {% endif %}
              - type: custom:uptime-card
                view_layout:
                  grid-area: c
                entity: binary_sensor.adsb_fr24_feeder_receiver_connected
                hours_to_show: 24
                update_interval: 30
                severity: 10
                bar:
                  height: 36
                  amount: 36
                tap_action:
                  action: none
                init:
                  animation: slide
                  slide duration: 0.5
                show:
                  header: false
                  title: false
                  icon: false
                  average: false
                  footer: false
                  timeline: true
                  status: false
                card_mod:
                  style: |-
                    ha-card {
                      border: none;
                      box-shadow: none;
                      margin-top: -5px ;
                      padding-top: 0px !important;
                      padding-bottom: 0px !important;
                    }
                    .timeline {
                      margin-top: 0px;
                      padding-top: 0px !important;
                      padding-left: 4px ;
                      padding-right: 4px;
                      }
      - type: custom:stack-in-card
        mode: vertical
        keep:
          margin: false
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: minmax(0, 1fr)
              grid-template-rows: auto
              grid-template-areas: |
                "a b"
                "c c"
            cards:
              - type: custom:mushroom-template-card
                view_layout:
                  grid-area: a
                entity: binary_sensor.adsb_fr24_mlat_connected
                primary: MLAT Connectivity
                secondary: |-
                  {% if is_state(config.entity, 'on') %}
                    connected
                  {% elif is_state(config.entity, 'off') %}
                    disconnected
                  {% else %}
                    unknown
                  {% endif %}
                icon: mdi:airplane-alert
                icon_color: |-
                  {% if is_state(config.entity, 'on') %}
                    #45C669
                  {% elif is_state(config.entity, 'off') %}
                    #C66445
                  {% else %}
                    disabled
                  {% endif %}
                fill_container: true
                tap_action:
                  action: more-info
                double_tap_action:
                  action: none
                hold_action:
                  action: none
                card_mod:
                  style: |-
                    {% if is_state(config.entity, 'on') %}
                      ha-card {
                        border: none;
                        box-shadow: none;
                        padding: 0px !important;
                        --primary-text-color: #45C669;
                        --secondary-text-color: #45C669;
                        }
                    {% elif is_state(config.entity, 'off') %}
                      ha-card {
                        border: none;
                        box-shadow: none;
                        padding: 0px !important;
                        --primary-text-color: #C66445;
                        --secondary-text-color: #C66445;
                      }
                    {% endif %}
                    {% if is_state(config.entity, 'off') %}
                      ha-state-icon {
                        animation: pulse 2s ease-in-out infinite;
                      }
                    {% endif %}
              - type: custom:uptime-card
                view_layout:
                  grid-area: c
                entity: binary_sensor.adsb_fr24_mlat_connected
                hours_to_show: 24
                update_interval: 30
                severity: 10
                bar:
                  height: 36
                  amount: 36
                tap_action:
                  action: none
                init:
                  animation: slide
                  slide duration: 0.5
                show:
                  header: false
                  title: false
                  icon: false
                  average: false
                  footer: false
                  timeline: true
                  status: false
                card_mod:
                  style: |-
                    ha-card {
                      border: none;
                      box-shadow: none;
                      margin-top: -5px ;
                      padding-top: 0px !important;
                      padding-bottom: 0px !important;
                    }
                    .timeline {
                      margin-top: 0px;
                      padding-top: 0px !important;
                      padding-left: 4px ;
                      padding-right: 4px;
                      }
  - type: conditional
    conditions:
      - condition: numeric_state
        entity: sensor.flightradar24_current_in_area
        above: 0
    card:
      type: markdown
      content: >-
        {% set data = state_attr('sensor.flightradar24_current_in_area',
        'flights') %} {% for flight in data %}
          <ha-icon icon="mdi:airplane"></ha-icon> {%if flight.airline_short %}{{ flight.airline_short }}{% endif %}{% if flight.flight_number %} {{ flight.flight_number }}{% endif %}{% if flight.airline_short or flight.flight_number %}, {% endif %}{% if flight.aircraft_model %}{{ flight.aircraft_model }}{% endif %}
          <div>{%if flight.airport_origin_city or flight.airport_destination_city %}{%if flight.airport_origin_city %}<div style="display: inline-block; margin-left: 28px;"><img style="vertical-align: middle;" src="https://flagsapi.com/{{ flight.airport_origin_country_code[:2] }}/shiny/16.png" />{% endif %} {{ flight.airport_origin_city }}</div>{%if flight.airport_destination_country_code %}<div style="display: inline-block;">&nbsp;-&nbsp;<img style="vertical-align: middle;" src="https://flagsapi.com/{{ flight.airport_destination_country_code[:2] }}/shiny/16.png" />{% endif %} {{ flight.airport_destination_city }}</div>{% else %}<div style="margin-left: 28px;">No data</div>{% endif %}</div></div>
        {% endfor %}