---
type: grid
columns: 1
square: false
cards:
  - type: custom:auto-entities
    sort:
      method: attribute
      attribute: sortorder
    card_param: cards
    filter:
      template: >-
        {%- for s in states|selectattr('entity_id','search','sensor.rssfeed_*') -%}
        {%- for e in state_attr(s.entity_id, 'entries')[0:2] -%}
          {{
          {
            "type": "custom:mushroom-template-card",
            "entity": s.entity_id,
            "secondary": "Latest News from {{state_attr(entity , 'friendly_name')}}",
            "primary": e.title,
            "icon": "{{state_attr(entity , 'icon')}}",
            "tap_action": {
                "action": "url",
                "url_path": e.link
            },
            "fill_container": true,
            "multiline_secondary": true,
            "prmary": "",
            "icon_color": "",
            "card_mod": {
                "style": "ha-card { background: none; box-shadow: none;}"
            }
          }
          }},
        {%- endfor %} {%- endfor %}
    show_empty: false
    card:
      type: custom:swipe-card
      parameters:
        direction: vertical
        autoHeight: true
        height: 50
        effect: cube
        autoplay:
          delay: 2000
        cubeEffect:
          - slideShadows: false
  - type: horizontal-stack
    cards:
      - type: custom:mushroom-light-card
        entity: light.office_lamp
        show_brightness_control: true
        tap_action:
          action: toggle
        use_light_color: true
        fill_container: true
        show_color_temp_control: false
        show_color_control: false
        collapsible_controls: false
        hold_action:
          action: more-info
        card_mod:
          style:
            mushroom-shape-icon$: |
              .shape:active {
                transform: scale(1.2);
              }
            .: |
              mushroom-light-brightness-control {
                position: absolute;
                top: 0px;
                left: 0px;
                width: 100%;
                opacity: 0.3;
                --control-height: 66px;
                --control-border-radius: var(--ha-card-border-radius, 12px);
                --rgb-disabled: var(--rgb-card-background-color);
              }
              mushroom-state-item {
                z-index: 1;
                max-width: fit-content;
                margin-bottom: 0px;
                pointer-events: none;
              }
              mushroom-shape-icon {
                pointer-events: auto;
              }
      - type: custom:mushroom-light-card
        entity: light.bedroom_lamp
        show_brightness_control: true
        tap_action:
          action: toggle
        use_light_color: true
        card_mod:
          style:
            mushroom-shape-icon$: |
              .shape:active {
                transform: scale(1.2);
              }
            .: |
              mushroom-light-brightness-control {
                position: absolute;
                top: 0px;
                left: 0px;
                width: 100%;
                opacity: 0.3;
                --control-height: 66px;
                --control-border-radius: var(--ha-card-border-radius, 12px);
                --rgb-disabled: var(--rgb-card-background-color);
              }
              mushroom-state-item {
                z-index: 1;
                max-width: fit-content;
                margin-bottom: 0px;
                pointer-events: none;
              }
              mushroom-shape-icon {
                pointer-events: auto;
              }

  - type: custom:decluttering-card
    template: mushroom_entity_graph
    variables:
      - entity: sensor.lastfm_user_playcount
      - colour: lime
      - title: Last.FM Listen Count
      - line_width: 3
      - hours_to_show: 168
      - points_per_hour: 4
      - icon: fab:lastfm

  - type: vertical-stack
    cards:
      - !include ../tamworth/nbn_fttnupgrade.yaml

  - !include ../../snippets/media_currently_playing_details.yaml

  - type: vertical-stack
    cards:
      - type: "custom:swipe-card"
        parameters:
          direction: vertical
          autoHeight: true
          height: 112
          effect: cube
          autoplay:
            delay: 10000
          cubeEffect:
            - slideShadows: false
        # view_layout:
        #   grid-column: 1/3
        #   grid-row: 3/4
        cards:
          - type: "custom:button-card"
            template:
              - live_tile_media_player
            entity: media_player.office_sonos
            icon: "phu:sonos-one"
            name: Sonos (Office)
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_media_player
            entity: media_player.bedroom_symfonisk
            icon: "phu:symfonisk-lampe"
            name: Sonos (Bedroom)
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_media_player
            entity: media_player.homepod_mini_bedroom_left
            icon: "mdi:album"
            name: Homepod Mini (Left)
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_media_player
            entity: media_player.homepod_mini_bedroom_right
            icon: "mdi:album"
            name: Homepod Mini (Right)
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_media_player
            entity: media_player.bedroom_apple_tv
            icon: "ios:tv-circle-fill"
            name: Apple TV
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_media_player
            entity: media_player.spotify_thomas_baxter
            icon: "mdi:spotify"
            name: Spotify
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_card
              - live_tile_conditional_media
            entity: sensor.frontpage_plex_unwatched_tv
            icon: "mdi:plex"
            name: Plex (New, Unwatched TV)
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_card
              - live_tile_conditional_media
            entity: sensor.frontpage_plex_unwatched_movies
            icon: "mdi:plex"
            name: Plex (New, Unwatched Movies)
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_card
              - live_tile_conditional_media
            entity: sensor.frontpage_sonarr_upcoming
            icon: "mdi:television"
            name: Sonarr (Upcoming TV)
            variables:
              aspect_ratio: 4/1
          - type: "custom:button-card"
            template:
              - live_tile_card
              - live_tile_conditional_media
            entity: sensor.frontpage_radarr_upcoming
            icon: "mdi:filmstrip"
            name: Radarr (Upcoming Movies)
            variables:
              aspect_ratio: 4/1
          - type: custom:mushroom-template-card
            primary: last.fm Top Artists
            secondary: >
              {{ state_attr('sensor.last_fm_top_artists', 'artist_1') }} ({{ state_attr('sensor.last_fm_top_artists', 'artist_1_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_artists', 'artist_2') }} ({{ state_attr('sensor.last_fm_top_artists', 'artist_2_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_artists', 'artist_3') }} ({{ state_attr('sensor.last_fm_top_artists', 'artist_3_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_artists', 'artist_4') }} ({{ state_attr('sensor.last_fm_top_artists', 'artist_4_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_artists', 'artist_5') }} ({{ state_attr('sensor.last_fm_top_artists', 'artist_5_playcount') }} Plays)
            icon: fab:lastfm
            icon_color: "red"
            fill_container: true
            multiline_secondary: true
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
          - type: custom:mushroom-template-card
            primary: last.fm Top Albums
            secondary: >
              {{ state_attr('sensor.last_fm_top_albums', 'album_1') }} ({{ state_attr('sensor.last_fm_top_albums', 'album_1_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_albums', 'album_2') }} ({{ state_attr('sensor.last_fm_top_albums', 'album_2_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_albums', 'album_3') }} ({{ state_attr('sensor.last_fm_top_albums', 'album_3_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_albums', 'album_4') }} ({{ state_attr('sensor.last_fm_top_albums', 'album_4_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_albums', 'album_5') }} ({{ state_attr('sensor.last_fm_top_albums', 'album_5_playcount') }} Plays)
            icon: fab:lastfm
            icon_color: "red"
            fill_container: true
            multiline_secondary: true
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none
          - type: custom:mushroom-template-card
            primary: last.fm Top Tracks
            secondary: >
              {{ state_attr('sensor.last_fm_top_tracks', 'track_1') }} ({{ state_attr('sensor.last_fm_top_tracks', 'track_1_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_tracks', 'track_2') }} ({{ state_attr('sensor.last_fm_top_tracks', 'track_2_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_tracks', 'track_3') }} ({{ state_attr('sensor.last_fm_top_tracks', 'track_3_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_tracks', 'track_4') }} ({{ state_attr('sensor.last_fm_top_tracks', 'track_4_playcount') }} Plays)

              {{ state_attr('sensor.last_fm_top_tracks', 'track_5') }} ({{ state_attr('sensor.last_fm_top_tracks', 'track_5_playcount') }} Plays)
            icon: fab:lastfm
            icon_color: "red"
            fill_container: true
            multiline_secondary: true
            tap_action:
              action: none
            hold_action:
              action: none
            double_tap_action:
              action: none

      - type: custom:gap-card
