---
title: Testing
icon: "mdi:ab-testing"
path: "test"
theme: "Fluent Red"

type: "custom:grid-layout"
layout: !include snippets/layout-page-margin.yaml

cards:
  - type: "custom:layout-card"
    layout_type: "custom:grid-layout"
    view_layout:
      grid-area: cc
    layout:
      grid-template-columns: "repeat(auto-fill, [col-start] minmax(450px, 1fr) [col-end])"
      grid-template-rows: auto
      grid-column-gap: 32px
      margin: -1px
      mediaquery:
        "(max-width: 800px)":
          grid-template-columns: "repeat(auto-fill, [col-start] minmax(240px, 1fr) [col-end])"

    cards:
      # [Header] Summary
      - type: "custom:layout-card"
        layout_type: "custom:grid-layout"
        layout: !include snippets/layout-page-title.yaml
        view_layout:
          grid-column: 1/-1
        cards:
          - type: markdown
            style: !include snippets/style-markdown-page-title.yaml
            content: >
              # Testing Page
          - type: "custom:layout-card"
            layout_type: "custom:grid-layout"
            layout:
              margin: 0
              padding: 0
              card_margin: 1px
            view_layout:
              place-self: end right
            cards:
              - entity: sensor.time
                template: clock
                type: custom:button-card
                variables:
                  entity_date: sensor.date
                  entity_temperature: sensor.tempest_st_00056115_temperature
                  entity_weather: weather.east_tamworth_hourly

      - type: vertical-stack
        cards:
          - type: custom:decluttering-card
            template: docker_uptime_card
            variables:
              - name: Sonarr
              - icon: phu:sonarr
              - switch_entity: switch.tbsh1_monitordocker_sonarr
              - update_entity: update.wud_container_local_sonarr
              - uptime_entity: binary_sensor.uptimekuma_service_external_sonarr
          - type: custom:decluttering-card
            template: docker_uptime_card
            variables:
              - name: Prowlarr
              - icon: mdi:magnify-expand
              - switch_entity: switch.tbsh1_monitordocker_prowlarr
              - update_entity: update.wud_container_local_prowlarr
              - uptime_entity: binary_sensor.uptimekuma_docker_tbsh1_prowlarr
          - type: sensor
            entity: sensor.yahoofinance_aapl
            graph: line
            detail: 1
            hours_to_show: 72
            card_mod:
              class: tile

      - type: custom:stack-in-card
        mode: vertical
        cards:
          - type: custom:mod-card
            card:
              type: custom:mushroom-title-card
              title: Transmission
            card_mod: !include snippets/style-mushroomtitlecard.yaml
          - type: custom:stack-in-card
            mode: horizontal
            cards:
              - type: custom:decluttering-card
                template: docker_uptime_card
                variables:
                  - name: Prowlarr
                  - icon: mdi:magnify-expand
                  - switch_entity: switch.tbsh1_monitordocker_prowlarr
                  - update_entity: update.wud_container_local_prowlarr
                  - uptime_entity: binary_sensor.uptimekuma_docker_tbsh1_prowlarr
              # - type: custom:mushroom-template-card
              #   entity: sensor.tbsh1_monitordocker_transmission
              #   layout: horizontal
              #   primary: Container Status
              #   tap_action:
              #     action: more-info
              #   secondary: >-
              #     {% if is_state('sensor.tbsh1_monitordocker_transmission','running') %}
              #       Running
              #     {% else %}
              #       Stopped
              #     {% endif %}
              #   icon: >-
              #     {% if is_state('sensor.tbsh1_monitordocker_transmission','running') %}
              #       mdi:check-circle
              #     {% else %}
              #       mdi:circle-outline
              #     {% endif %}
              #   icon_color: >-
              #     {% if is_state('sensor.tbsh1_monitordocker_transmission','running') %}
              #       green
              #     {% else %}
              #       red
              #     {% endif %}
              #   card_mod:
              #     style: |
              #       ha-card {
              #         padding-top: 5px !important;
              #       }
              - type: custom:mushroom-template-card
                entity: sensor.tbsh1_monitordocker_transmission
                layout: horizontal
                primary: Uptime
                secondary: >-
                  {{- state_attr('sensor.tbsh1_monitordocker_transmission','uptime')|as_datetime|relative_time -}}
                tap_action:
                  action: more-info
                icon: mdi:clock-alert-outline
                icon_color: grey
                card_mod:
                  style: |
                    ha-card {
                      padding-top: 5px !important;
                    }
          - type: custom:mushroom-template-card
            entity: sensor.tbsh1_monitordocker_transmission
            layout: horizontal
            primary: Image
            secondary: >-
              {{- state_attr('sensor.tbsh1_monitordocker_transmission','image') -}}
            tap_action:
              action: more-info
            icon: mdi:server
            icon_color: grey
            card_mod:
              style: |
                ha-card {
                  padding-top: 5px !important;
                }
          - type: custom:stack-in-card
            mode: horizontal
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.tbsh1_monitordocker_transmission
                primary: CPU
                secondary: >-
                  {{- state_attr('sensor.tbsh1_monitordocker_transmission','cpu_percentage') -}} %
                icon: mdi:chip
                icon_color: grey
                tap_action:
                  action: more-info
                card_mod:
                  style: |
                    ha-card {
                      padding-top: 5px !important;
                    }
              - type: custom:layout-card
                layout_type: custom:masonry-layout
                layout:
                  width: 220
                  max_cols: 2
                  height: auto
                  padding: 0px
                  card_margin: var(--masonry-view-card-margin, 4px 4px 4px 4px)
                cards:
                  - type: custom:mini-graph-card
                    name: CPU
                    entities:
                      - entity: sensor.tbsh1_monitordocker_transmission
                        attribute: cpu_percentage
                        state_adaptive_color: true
                        show_fill: false
                    decimals: 1
                    hour24: true
                    hours_to_show: 24
                    height: 80
                    line_width: 4
                    show:
                      name: false
                      graph: line
                      icon: false
                      state: false
                      legend: false
                      points: false
                      labels: false
                    color_thresholds:
                      - color: "#636154"
                        value: 0
                      - color: "#6ac6f9"
                        value: 10
                      - color: "#fbed63"
                        value: 25
                      - color: "#ffb748"
                        value: 50
                      - color: "#f0341f"
                        value: 85
                    card_mod:
                      style: |
                        ha-card {
                          background: none;
                          box-shadow: none;
                          --ha-card-border-width: 0;
                          padding-top: 5px !important;
                        }
          - type: custom:stack-in-card
            mode: horizontal
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.tbsh1_monitordocker_transmission
                primary: Memory
                secondary: >-
                  {{- state_attr('sensor.tbsh1_monitordocker_transmission','memory_percentage') -}} %
                icon: mdi:memory
                icon_color: grey
                tap_action:
                  action: more-info
                card_mod:
                  style: |
                    ha-card {
                      padding-top: 5px !important;
                    }
              - type: custom:layout-card
                layout_type: custom:masonry-layout
                layout:
                  width: 220
                  max_cols: 2
                  height: auto
                  padding: 0px
                  card_margin: var(--masonry-view-card-margin, 4px 4px 4px 4px)
                cards:
                  - type: custom:mini-graph-card
                    name: Memory
                    entities:
                      - entity: sensor.tbsh1_monitordocker_transmission
                        attribute: memory_percentage
                        state_adaptive_color: true
                        show_fill: false
                    decimals: 1
                    hour24: true
                    hours_to_show: 24
                    height: 80
                    line_width: 4
                    show:
                      name: false
                      graph: line
                      icon: false
                      state: false
                      legend: false
                      points: false
                      labels: false
                    color_thresholds:
                      - color: "#636154"
                        value: 0
                      - color: "#6ac6f9"
                        value: 10
                      - color: "#fbed63"
                        value: 25
                      - color: "#ffb748"
                        value: 50
                      - color: "#f0341f"
                        value: 85
                    card_mod:
                      style: |
                        ha-card {
                          background: none;
                          box-shadow: none;
                          --ha-card-border-width: 0;
                          padding-top: 5px !important;
                        }
          - type: custom:mushroom-update-card
            entity: update.wud_container_local_transmission
            name: Container Update Status
            show_buttons_control: true

      - type: custom:stack-in-card
        mode: vertical
        keep:
          outer_padding: true
        cards:
          - type: custom:layout-card
            layout_type: grid
            layout:
              grid-template-columns: 70% 30%
              grid-gap: 0px;
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.yahoofinance_audusd_x
                primary: ^AEX
                secondary: "{{state_attr(entity, 'friendly_name')}}"
                icon: mdi:currency-eur
                icon_color: grey
                card_mod:
                  style:
                    mushroom-shape-icon$: |
                      .shape:after {
                        font-size: 20px;
                        content: '🇳🇱';
                      }
                      ha-icon {
                        width: 0px !important;
                      }
                    .: |
                      ha-card {
                        box-shadow: none;
                        margin: -4px -7px;
                      }
              - type: custom:mushroom-template-card
                entity: sensor.yahoofinance_audusd_x
                primary: "{{states(entity)}}"
                secondary: |
                  {% if state_attr(entity, 'trending') == "up" %}+{% endif
                  %}{{state_attr(entity,'regularMarketChangePercent')}}%
                card_mod:
                  style:
                    mushroom-state-info$: |
                      * {
                        text-align: end;
                      }
                    .: |
                      ha-card {
                        --secondary-text-color: {% if state_attr(config.entity, 'trending') == "up" %}rgba(var(--rgb-green)){% else %}rgba(var(--rgb-red)){% endif %};
                        margin: -3px 2px -6px 0px;
                        box-shadow: none;
                      }
          - type: custom:mushroom-template-card
            card_mod:
              style: |
                ha-card {
                  margin: -25px 12px 0px 12px;
                  border-bottom: solid 2px rgba(var(--rgb-disabled), 0.2);
                }
          - type: custom:layout-card
            layout_type: grid
            layout:
              grid-template-columns: 70% 30%
              grid-gap: 0px;
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.yahoofinance_aapl
                primary: "{{state_attr(entity, 'symbol')}}"
                secondary: "{{state_attr(entity, 'friendly_name')}}"
                icon: '{{state_attr(entity,"icon")}}'
                icon_color: |
                  {% if state_attr(entity, 'trending') == "up" %}green{% else %}red{% endif %}
                tap_action:
                  action: more-info
                card_mod:
                  style: |
                    ha-card {
                      box-shadow: none;
                      margin: -4px -7px;
                    }
              - type: custom:mushroom-template-card
                entity: sensor.yahoofinance_aapl
                primary: |
                  {{state_attr(entity, 'currencySymbol')}}{{states(entity)}}
                tap_action:
                  action: more-info
                secondary: |
                  {% if state_attr(entity, 'trending') == "up" %}+{% endif
                  %}{{state_attr(entity,'regularMarketChangePercent')}}%
                card_mod:
                  style:
                    mushroom-state-info$: |
                      * {
                        text-align: end;
                      }
                    .: |
                      ha-card {
                        --secondary-text-color: {% if state_attr(config.entity, 'trending') == "up" %}rgba(var(--rgb-green)){% else %}rgba(var(--rgb-red)){% endif %};
                        margin: -3px 2px -6px 0px;
                        box-shadow: none;
                      }

      - type: custom:stack-in-card
        mode: vertical
        keep:
          outer_padding: true
        cards:
          - type: custom:layout-card
            layout_type: grid
            layout:
              grid-template-columns: 70% 30%
              grid-gap: 0px;
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_e10
                primary: E10
                secondary: "Max: {{state_attr(entity, 'max')}}c/L - Min: {{state_attr(entity, 'min')}}c/L"
                icon: mdi:gas-station
                icon_color: orange
                card_mod:
                  style: |
                    ha-card {
                      box-shadow: none;
                      margin: -4px -7px;
                      padding-top: 5px !important;
                      padding-bottom: 5px !important;
                    }
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_e10
                primary: "{{states(entity)}}c/L"
                card_mod:
                  style:
                    mushroom-state-info$: |
                      * {
                        text-align: end;
                      }
                    .: |
                      ha-card {
                        margin: 6px 2px -6px 0px;
                        box-shadow: none;
                        padding-top: 5px !important;
                        padding-bottom: 5px !important;
                      }
          - type: custom:mushroom-template-card
            card_mod:
              style: |
                ha-card {
                  margin: -25px 12px 0px 12px;
                  border-bottom: solid 2px rgba(var(--rgb-disabled), 0.2);
                }
          - type: custom:layout-card
            layout_type: grid
            layout:
              grid-template-columns: 70% 30%
              grid-gap: 0px;
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_ulp91
                primary: U91
                secondary: "Max: {{state_attr(entity, 'max')}}c/L - Min: {{state_attr(entity, 'min')}}c/L"
                icon: mdi:gas-station
                icon_color: orange
                card_mod:
                  style: |
                    ha-card {
                      box-shadow: none;
                      margin: -4px -7px;
                      padding-top: 5px !important;
                      padding-bottom: 5px !important;
                    }
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_ulp91
                primary: "{{states(entity)}}c/L"
                secondary: ""
                card_mod:
                  style:
                    mushroom-state-info$: |
                      * {
                        text-align: end;
                      }
                    .: |
                      ha-card {
                        margin: 6px 2px -6px 0px;
                        box-shadow: none;
                        padding-top: 5px !important;
                        padding-bottom: 5px !important;
                      }
          - type: custom:mushroom-template-card
            card_mod:
              style: |
                ha-card {
                  margin: -25px 12px 0px 12px;
                  border-bottom: solid 2px rgba(var(--rgb-disabled), 0.2);
                }
          - type: custom:layout-card
            layout_type: grid
            layout:
              grid-template-columns: 70% 30%
              grid-gap: 0px;
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_ulp95
                primary: P95
                secondary: "Max: {{state_attr(entity, 'max')}}c/L - Min: {{state_attr(entity, 'min')}}c/L"
                icon: mdi:gas-station
                icon_color: orange
                card_mod:
                  style: |
                    ha-card {
                      box-shadow: none;
                      margin: -4px -7px;
                      padding-top: 5px !important;
                      padding-bottom: 5px !important;
                    }
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_ulp95
                primary: "{{states(entity)}}c/L"
                secondary: ""
                card_mod:
                  style:
                    mushroom-state-info$: |
                      * {
                        text-align: end;
                      }
                    .: |
                      ha-card {
                        margin: 6px 2px -6px 0px;
                        box-shadow: none;
                        padding-top: 5px !important;
                        padding-bottom: 5px !important;
                      }
          - type: custom:mushroom-template-card
            card_mod:
              style: |
                ha-card {
                  margin: -25px 12px 0px 12px;
                  border-bottom: solid 2px rgba(var(--rgb-disabled), 0.2);
                }
          - type: custom:layout-card
            layout_type: grid
            layout:
              grid-template-columns: 70% 30%
              grid-gap: 0px;
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_ulp98
                primary: P98
                secondary: "Max: {{state_attr(entity, 'max')}}c/L - Min: {{state_attr(entity, 'min')}}c/L"
                icon: mdi:gas-station
                icon_color: orange
                card_mod:
                  style: |
                    ha-card {
                      box-shadow: none;
                      margin: -4px -7px;
                      padding-top: 5px !important;
                      padding-bottom: 5px !important;
                    }
              - type: custom:mushroom-template-card
                entity: sensor.tamworth_fuel_average_ulp98
                primary: "{{states(entity)}}c/L"
                secondary: ""
                card_mod:
                  style:
                    mushroom-state-info$: |
                      * {
                        text-align: end;
                      }
                    .: |
                      ha-card {
                        margin: 6px 2px -6px 0px;
                        box-shadow: none;
                        padding-top: 5px !important;
                        padding-bottom: 5px !important;
                      }

      - type: custom:stack-in-card
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                entity: sensor.active_generation
                secondary: Now
                primary: |
                  {{ states('sensor.active_generation') | round(0) }} W
                icon: mdi:sun-wireless
                icon_color: orange
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                entity: sensor.daily_generation
                secondary: Daily
                primary: |
                  {{ states('sensor.daily_generation') | round(2) }} KwH
                icon: mdi:sun-clock
                icon_color: orange
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                entity: sensor.daily_export_to_grid
                secondary: Grid
                primary: |
                  {{ states('sensor.daily_export_to_grid') | round(2) }} KwH
                name: Grid
                icon: mdi:solar-power
                icon_color: green
                tap_action:
                  action: more-info
          - type: custom:apexcharts-card
            graph_span: 1d
            span:
              start: day
            apex_config:
              chart:
                height: 200px
              legend:
                show: false
              stroke:
                width: 2
              plotOptions:
                bar:
                  columnWidth: 100%
              grid:
                show: true
                borderColor: "#00000030"
                strokeDashArray: 4
                position: back
            experimental:
              color_threshold: true
            header:
              show: false
              show_states: false
              colorize_states: true
            yaxis:
              - id: first
                decimals: 1
                apex_config:
                  tickAmount: 2
              - id: second
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 2
            series:
              - entity: sensor.load_power
                transform: "return x / 1000;"
                name: Power
                yaxis_id: first
                show:
                  legend_value: false
                type: column
                group_by:
                  func: avg
                  duration: 15min
                color_threshold:
                  - value: 0
                    color: "#228B22"
                  - value: 1
                    color: "#d35400"
                  - value: 3
                    color: "#c0392b"
              - entity: sensor.active_generation
                transform: "return x / 1000;"
                name: Solar
                yaxis_id: second
                type: area
                curve: smooth
                opacity: 0.2
                color: "#00bb33"
                extend_to: false
                show:
                  legend_value: false
                group_by:
                  func: avg
                  duration: 15min

      - type: custom:mushroom-chips-card
        chips:
          - type: conditional
            conditions:
              - entity: sensor.devices_with_low_battery
                state_not: "0"
            chip:
              type: template
              entity: sensor.devices_with_low_battery
              icon_color: red
              icon: mdi:battery-alert
              content: "{{ states(entity) }}"
              tap_action:
                action: fire-dom-event
                browser_mod:
                  service: browser_mod.popup
                  data:
                    title: Low Batteries
                    content:
                      type: custom:auto-entities
                      filter:
                        include:
                          - attributes:
                              device_class: battery
                            state: < 30
                            options:
                              type: custom:mushroom-template-card
                              primary: "{{ states(entity) }}%"
                              secondary: "{{ state_attr(entity, 'friendly_name') | title }}"
                              icon: >
                                {% set battery_level = (states(entity) | int / 10) |
                                round(0) | int * 10 %} {% if battery_level == 100 %}
                                  mdi:battery
                                {% elif battery_level > 0 %}
                                  mdi:battery-{{ battery_level }}
                                {% else %}
                                  mdi:battery-outline
                                {% endif %}
                              icon_color: |-
                                {% set battery_level = states(entity) | int %}
                                {% if battery_level > 90 %}
                                  green
                                {% elif battery_level > 60 %}
                                  light-green
                                {% elif battery_level > 50 %}
                                  lime
                                {% elif battery_level > 40 %}
                                  yellow
                                {% elif battery_level > 30 %}
                                  amber
                                {% elif battery_level > 20 %}
                                  orange
                                {% elif battery_level > 10 %}
                                  deep-orange
                                {% else %}
                                  red
                                {% endif %}
                              layout: horizontal
                              tap_action:
                                action: none
                              badge_icon: |-
                                {% set battery_level = states(entity) | int %}
                                {% if battery_level < 10 %}
                                  mdi:exclamation-thick
                                {% endif %}
                              badge_color: red
                              card_mod:
                                style: |
                                  ha-card {
                                    padding: 4px 12px !important;
                                  }
                        exclude: null
                      show_empty: false
                      card:
                        type: custom:layout-card
                        cards: []
                        layout_type: masonry
                      sort:
                        method: friendly_name

      - type: custom:stack-in-card
        cards:
          - type: custom:mushroom-template-card
            primary: HA Server
            secondary: "Uptime: {{ states('sensor.systemuptime') }}"
            icon: mdi:server-network
            tap_action: none
            icon_color: |
              {% if states('sensor.cpu_temperature') | int > 80 %}
                red
              {% elif states('sensor.cpu_temperature') | int > 70 %}
                orange
              {% elif states('sensor.cpu_temperature') | int > 60 %}
                yellow
              {% else %}
                green
              {% endif %}
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                entity: sensor.cpu_temperature
                content: "{{ states(entity) }} °C"
                icon: mdi:thermometer
                icon_color: |
                  {% if states('sensor.cpu_temperature') | int > 80 %}
                    red
                  {% elif states('sensor.cpu_temperature') | int > 70 %}
                    orange
                  {% elif states('sensor.cpu_temperature') | int > 60 %}
                    yellow
                  {% else %}
                    green
                  {% endif %}
                tap_action: none
              - type: template
                entity: sensor.processor_use
                content: "{{ states(entity) }} %"
                icon_color: |
                  {% if states('sensor.processor_use') | int > 80 %}
                    red
                  {% elif states('sensor.processor_use') | int > 70 %}
                    orange
                  {% elif states('sensor.processor_use') | int > 60 %}
                    yellow
                  {% else %}
                    green
                  {% endif %}
                tap_action: none
                icon: mdi:cpu-64-bit
              - type: template
                entity: sensor.memory_use_percent
                content: "{{ states(entity) }} %"
                icon: mdi:memory
                icon_color: |
                  {% if states('sensor.memory_use_percent') | int > 80 %}
                    red
                  {% elif states('sensor.memory_use_percent') | int > 70 %}
                    orange
                  {% elif states('sensor.memory_use_percent') | int > 60 %}
                    yellow
                  {% else %}
                    green
                  {% endif %}
                tap_action: none
              - type: template
                entity: sensor.disk_use_percent
                content: "{{ states(entity) }} %"
                icon: mdi:harddisk
                icon_color: |
                  {% if states('sensor.disk_use_percent') | int > 80 %}
                    red
                  {% elif states('sensor.disk_use_percent') | int > 70 %}
                    orange
                  {% elif states('sensor.disk_use_percent') | int > 60 %}
                    yellow
                  {% else %}
                    green
                  {% endif %}
                tap_action: none
              - type: entity
                entity: sensor.ha_db_size
            alignment: end

      - type: custom:mushroom-chips-card
        chips:
          - type: template
            content: |-
              {{ states('sensor.tempest_st_00056115_temperature') }} °C
            icon: |-
              {% if is_state('weather.east_tamworth', 'sunny') %}
              mdi:weather-sunny
              {% elif is_state('weather.east_tamworth', 'partlycloudy') %}
              mdi:weather-partly-cloudy
              {% elif is_state('weather.east_tamworth', 'cloudy') %}
              mdi:weather-cloudy
              {% elif is_state('weather.east_tamworth', 'rainy') %}
              mdi:weather-rainy
              {% elif is_state('weather.east_tamworth', 'partly-rainy') %}
              mdi:weather-partly-rainy
              {% elif is_state('weather.east_tamworth', 'pouring') %}
              mdi:weather-pouring
              {% elif is_state('weather.east_tamworth', 'fog') %}
              mdi:weather-fog
              {% elif is_state('weather.east_tamworth', 'hail') %}
              mdi:weather-hail
              {% elif is_state('weather.east_tamworth', 'hazy') %}
              mdi:weather-hazy
              {% elif is_state('weather.east_tamworth', 'lightning') %}
              mdi:weather-lightning
              {% elif is_state('weather.east_tamworth', 'lightning-rainy') %}
              mdi:weather-lightning-rainy
              {% elif is_state('weather.east_tamworth', 'partly-lightning') %}
              mdi:weather-partly-lightning
              {% elif is_state('weather.east_tamworth', 'snowy') %}
              mdi:weather-snowy
              {% elif is_state('weather.east_tamworth', 'snowy-heavy') %}
              mdi:weather-snowy-heavy
              {% elif is_state('weather.east_tamworth', 'snowy-rainy') %}
              mdi:weather-snowy-rainy
              {% elif is_state('weather.east_tamworth', 'partly-snowy') %}
              mdi:weather-partly-snowy
              {% elif is_state('weather.east_tamworth', 'partly-snowy-rainy') %}
              mdi:weather-partly-snowy-rainy
              {% elif is_state('weather.east_tamworth', 'clear-night') %}
              mdi:weather-night
              {% elif is_state('weather.east_tamworth', 'night-partly-cloudy') %}
              mdi:weather-night-partly-cloudy
              {% endif %}
            icon_color: >-
              {% if is_state('weather.east_tamworth', 'sunny') %} #FFF900 {% elif
              is_state('weather.east_tamworth', 'partlycloudy') %} #B3B6B7 {% elif
              is_state('weather.east_tamworth', 'cloudy') %} #626567 {% elif
              is_state('weather.east_tamworth', 'rainy') %} #5757BE {% elif
              is_state('weather.east_tamworth', 'partly-rainy') %} #4E4DD8 {% elif
              is_state('weather.east_tamworth', 'pouring') %} #2E9AFE {% elif
              is_state('weather.east_tamworth', 'fog') %} #C0C0C0 {% elif
              is_state('weather.east_tamworth', 'hail') %} white {% elif
              is_state('weather.east_tamworth', 'hazy') %} grey {% elif
              is_state('weather.east_tamworth', 'lightning') %} #D9D401 {% elif
              is_state('weather.east_tamworth', 'lightning-rainy') %} #D9D401 {% elif
              is_state('weather.east_tamworth', 'partly-lightning') %} #D9D401 {% elif
              is_state('weather.east_tamworth', 'snowy') %} #FFFFFF {% elif
              is_state('weather.east_tamworth', 'snowy-heavy') %} #FFFFFF {% elif
              is_state('weather.east_tamworth', 'snowy-rainy') %} #FFFFFF {% elif
              is_state('weather.east_tamworth', 'partly-snowy') %} #FFFFFF {% elif
              is_state('weather.east_tamworth', 'partly-snowy-rainy') %} #FFFFFF {% elif
              is_state('weather.east_tamworth', 'clear-night') %} #FFF900 {% elif
              is_state('weather.east_tamworth', 'night-partly-cloudy') %} #B3B6B7 {%
              endif %}
        card_mod:
          style:
            mushroom-template-chip:nth-child(1)$: |
              ha-icon {
                {%- set sensor = states('weather.east_tamworth') %}
                {%- if sensor == 'sunny' %}
                  animation: sunny 8s ease-in-out infinite alternate;
                {%- elif sensor == 'partly-cloudy' %}
                  animation: cloudy 10s ease-in-out infinite, sun 2s infinite;
                {%- elif sensor == 'cloudy' %}
                  animation: cloudy 10s ease-in-out infinite;
                {%- elif sensor == 'rainy' %}
                  animation: cloudy 10s ease-in-out infinite, rain 1.5s infinite;
                {%- elif sensor == 'pouring' %}
                  animation: cloudy 10s ease-in-out infinite, pouring 1s infinite;
                {%- elif sensor == 'fog' %}
                  animation: cloudy 10s ease-in-out infinite, fog 4s infinite;
                {%- elif sensor == 'hail' %}
                  animation: cloudy 10s ease-in-out infinite, hail 2s infinite;
                {%- elif sensor == 'lightning' %}
                  animation: cloudy 10s ease-in-out infinite, lightning 4s infinite;
                {%- elif sensor == 'snow' %}
                  animation: cloudy 10s ease-in-out infinite, snow 4s infinite;
                {%- elif sensor == 'clear-night' %}
                  animation: moon 10s linear infinite, stars 5s linear infinite;
                {%- endif %}
              }
              @keyframes cloudy {
                0%, 100% { transform: translateX(3px); }
                30% { transform: translateX(-1px); }
                45% { transform: translateX(1.5px); }
                75% { transform: translateX(-3.2px); }
              }
              @keyframes sun {
                50% { clip-path: polygon(0 67%, 18% 55%, 16% 31%, 41% 12%, 67% 24%, 77% 59%, 100% 64%, 100% 100%, 0 100%); }
              }
              @keyframes sunny {
                70% { transform: rotate(360deg) scale(1); }
                80% { transform: scale(1); }
                90% { transform: scale(1.15); }
                100% { transform: scale(1); }
              }
              @keyframes rain {
                50% { clip-path: polygon(0 0, 100% 0, 100% 73%, 71% 73%, 50% 39%, 29% 73%, 0 73%); }
              }
              @keyframes pouring {
                0%, 50%, 100% { clip-path: inset(0 0 0 0); }
                25% { clip-path: polygon(0 0, 100% 0, 100% 83%, 54% 83%, 62% 47%, 47% 46%, 38% 83%, 0 83%); }
                75%  { clip-path: polygon(0 0, 100% 0, 100% 70%, 75% 70%, 80% 48%, 63% 48%, 54% 94%, 32% 94%, 46% 46%, 30% 46%, 23% 72%, 0 72%); }
              }
              @keyframes fog {
                0%, 26%, 76%, 100% { clip-path: inset(0 0 0 0); }
                25% { clip-path: polygon(0 0, 100% 0, 100% 59%, 60% 59%, 60% 74%, 100% 74%, 100% 100%, 0 100%); }
                75%  { clip-path: polygon(0 0, 100% 0, 100% 100%, 26% 100%, 26% 76%, 0 76%); }
              }
              @keyframes hail {
                0%, 26%, 51%, 76%, 100% { clip-path: inset(0 0 0 0); }
                25% { clip-path: polygon(0 0, 100% 0, 100% 100%, 62% 100%, 47% 69%, 56% 55%, 43% 43%, 31% 58%, 48% 68%, 63% 100%, 0 100%); }
                50%  { clip-path: polygon(0 0, 100% 0, 100% 100%, 62% 100%, 61% 86%, 74% 74%, 61% 60%, 46% 69%, 60% 87%, 63% 100%, 0 100%); }
                75%  { clip-path: polygon(0 0, 100% 0, 100% 100%, 47% 100%, 56% 83%, 42% 68%, 27% 81%, 37% 100%, 0 100%); }
              }
              @keyframes lightning {
                10%, 15% { clip-path: polygon(0 0, 100% 0, 100% 100%, 47% 100%, 69% 55%, 66% 40%, 48% 39%, 24% 100%, 0 100%); transform: scale(1.1); }
                10.1%, 15.1% { clip-path: inset(0 0 0 0); transform: scale(1); }
              }
              @keyframes snow {
                50% { clip-path: polygon(0 0, 100% 0, 100% 100%, 65% 100%, 76% 73%, 57% 49%, 34% 56%, 26% 79%, 37% 100%, 0 100%); }
                51% { clip-path: inset(0 0 0 0); }
              }
              @keyframes moon {
                0%, 100% { transform: rotate(12deg); }
                30% { transform: rotate(-6deg); }
                45% { transform: rotate(8deg); }
                75% { transform: rotate(-10deg); }
              }
              @keyframes stars {
                0%, 3.1%, 14.1% { clip-path: inset(0 0 0 0); }
                3% { clip-path: polygon(1% 1%, 0% 99%, 99% 100%, 99% 62%, 68% 62%, 62% 44%, 76% 34%, 100% 34%, 99% 0%); }
                14% { clip-path: polygon(1% 1%, 0% 99%, 99% 100%, 100% 25%, 51% 45%, 38% 34%, 36% 0); }
              }

      - type: custom:stack-in-card
        cards:
          - type: grid
            square: false
            columns: 3
            cards:
              - type: custom:stack-in-card
                cards:
                  - type: custom:apexcharts-card
                    chart_type: radialBar
                    series:
                      - entity: sensor.processor_use
                        color: rgb(76, 175, 80)
                        max: 100
                        show:
                          legend_value: false
                    apex_config:
                      plotOptions:
                        radialBar:
                          offsetY: 0
                          startAngle: -108
                          endAngle: 108
                          hollow:
                            size: 65%
                          dataLabels:
                            name:
                              show: false
                            value:
                              show: false
                          track:
                            strokeWidth: 80%
                            margin: 0
                      legend:
                        show: false
                      chart:
                        height: 170px
                  - type: custom:mushroom-entity-card
                    entity: sensor.processor_use
                    primary_info: name
                    secondary_info: state
                    name: Core
                    icon_color: green
                    layout: vertical
                    card_mod:
                      style: |
                        ha-card {
                          top: -63px;
                        }
                card_mod:
                  style: |
                    ha-card {
                      height: 158px;
                    }
              - type: custom:stack-in-card
                cards:
                  - type: custom:apexcharts-card
                    chart_type: radialBar
                    series:
                      - entity: sensor.memory_use_percent
                        color: rgb(33, 150, 243)
                        max: 100
                        show:
                          legend_value: false
                    apex_config:
                      plotOptions:
                        radialBar:
                          offsetY: 0
                          startAngle: -108
                          endAngle: 108
                          hollow:
                            size: 65%
                          dataLabels:
                            name:
                              show: false
                            value:
                              show: false
                          track:
                            strokeWidth: 80%
                            margin: 0
                      legend:
                        show: false
                      chart:
                        height: 170px
                  - type: custom:mushroom-entity-card
                    entity: sensor.memory_use_percent
                    primary_info: name
                    secondary_info: state
                    name: Memory
                    icon_color: blue
                    layout: vertical
                    card_mod:
                      style: |
                        ha-card {
                          top: -63px;
                        }
                card_mod:
                  style: |
                    ha-card {
                      height: 158px;
                    }
              - type: custom:stack-in-card
                cards:
                  - type: custom:apexcharts-card
                    chart_type: radialBar
                    series:
                      - entity: sensor.disk_use_percent
                        color: rgb(233, 30, 99)
                        max: 100
                        show:
                          legend_value: false
                    apex_config:
                      plotOptions:
                        radialBar:
                          offsetY: 0
                          startAngle: -108
                          endAngle: 108
                          hollow:
                            size: 65%
                          dataLabels:
                            name:
                              show: false
                            value:
                              show: false
                          track:
                            strokeWidth: 80%
                            margin: 0
                      legend:
                        show: false
                      chart:
                        height: 170px
                  - type: custom:mushroom-entity-card
                    entity: sensor.disk_use_percent
                    primary_info: name
                    secondary_info: state
                    name: Disk
                    icon_color: pink
                    layout: vertical
                    card_mod:
                      style: |
                        ha-card {
                          top: -63px;
                        }
                card_mod:
                  style: |
                    ha-card {
                      height: 158px;
                    }
