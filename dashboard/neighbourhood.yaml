---
title: Tamworth
path: tamworth
theme: "Fluent Red"
icon: mdi:map-marker-account-outline

type: "custom:grid-layout"
layout: !include snippets/layout-page-margin.yaml

cards:
  - type: "custom:layout-card"
    layout_type: "custom:grid-layout"
    view_layout:
      grid-area: cc
    layout:
      grid-template-columns: "repeat(auto-fill, [col-start] minmax(450px, 1fr) [col-end])"
      grid-template-rows: auto
      grid-column-gap: 32px
      margin: -1px

    cards:
      # [Header] Summary
      - type: "custom:layout-card"
        layout_type: "custom:grid-layout"
        layout: !include snippets/layout-page-title.yaml
        view_layout:
          grid-column: 1/-1
        cards:
          - type: markdown
            style: !include snippets/style-markdown-page-title.yaml
            content: >
              # Tamworth
          - type: "custom:layout-card"
            layout_type: "custom:grid-layout"
            layout:
              margin: 0
              padding: 0
              card_margin: 1px
            view_layout:
              place-self: end right
            cards:
              - entity: sensor.time
                template: clock
                type: custom:button-card
                variables:
                  entity_date: sensor.date
                  entity_temperature: sensor.tempest_st_00056115_temperature
                  entity_weather: weather.east_tamworth_hourly

      # # [Column] Transit
      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card
            variables:
              name: FIRE DANGER (NEXT 4 DAYS)
              label: NSW RFS
              arrow: "mdi:arrow-top-right"
              action: url
              link: "https://www.rfs.nsw.gov.au/"
            view_layout:
              grid-column-start: 1
              grid-column-end: -1
          # Fire Danger Today
          - type: horizontal-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: picture-entity
                    entity: sensor.fire_danger_northern_slopes_danger_level_today
                    show_name: false
                    show_state: false
                    state_image:
                      "None": /local/icons/fire_danger/fdr-no-rating.svg
                      "Moderate": /local/icons/fire_danger/fdr-moderate.svg
                      "High": /local/icons/fire_danger/fdr-high.svg
                      "Extreme": /local/icons/fire_danger/fdr-extreme.svg
                      "Catastrophic": /local/icons/fire_danger/fdr-catastrophic.svg
              - type: vertical-stack
                cards:
                  - type: picture-entity
                    entity: sensor.fire_danger_northern_slopes_danger_level_tomorrow
                    show_name: false
                    show_state: false
                    state_image:
                      "None": /local/icons/fire_danger/fdr-no-rating.svg
                      "Moderate": /local/icons/fire_danger/fdr-moderate.svg
                      "High": /local/icons/fire_danger/fdr-high.svg
                      "Extreme": /local/icons/fire_danger/fdr-extreme.svg
                      "Catastrophic": /local/icons/fire_danger/fdr-catastrophic.svg
          - type: horizontal-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: picture-entity
                    entity: sensor.fire_danger_northern_slopes_danger_level_day_3
                    show_name: false
                    show_state: false
                    state_image:
                      "None": /local/icons/fire_danger/fdr-no-rating.svg
                      "Moderate": /local/icons/fire_danger/fdr-moderate.svg
                      "High": /local/icons/fire_danger/fdr-high.svg
                      "Extreme": /local/icons/fire_danger/fdr-extreme.svg
                      "Catastrophic": /local/icons/fire_danger/fdr-catastrophic.svg
              - type: vertical-stack
                cards:
                  - type: picture-entity
                    entity: sensor.fire_danger_northern_slopes_danger_level_day_4
                    show_name: false
                    show_state: false
                    state_image:
                      "None": /local/icons/fire_danger/fdr-no-rating.svg
                      "Moderate": /local/icons/fire_danger/fdr-moderate.svg
                      "High": /local/icons/fire_danger/fdr-high.svg
                      "Extreme": /local/icons/fire_danger/fdr-extreme.svg
                      "Catastrophic": /local/icons/fire_danger/fdr-catastrophic.svg

      # [Column] Traffic
      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card
            variables:
              name: TRAFFIC
              label: Waze
              arrow: "mdi:arrow-top-right"
              action: url
              link: "https://www.waze.com/live-map"
            view_layout:
              grid-column-start: 1
              grid-column-end: -1

          - type: iframe
            url: !secret waze_url
            aspect_ratio: 120%

          # - type: picture
          #   image: !secret virtualearth_image_path
          #   tap_action:
          #     action: url
          #     url_path: !secret googlemaps_path

          - type: custom:apexcharts-card
            config_templates: chart_style
            graph_span: 7d
            span:
              end: day
            header:
              show: true
              title: Driving Time
              show_states: true
              colorize_states: true
            apex_config:
              height: 300px
            all_series_config:
              stroke_width: 2
              opacity: 0.3
              type: area
              curve: stepline
              extend_to: now
              group_by:
                func: last
                duration: 30m
            series:
              - entity: sensor.here_home_to_work_duration_in_traffic
                name: Home to Work
                show:
                  legend_value: false
              - entity: sensor.here_tom_to_work_duration_in_traffic
                name: Tom to Work
                show:
                  legend_value: false
              - entity: sensor.here_tom_to_home_duration_in_traffic
                name: Tom to Home
                show:
                  legend_value: false

      # [Column] Traffic
      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card
            variables:
              name: LIVE TRAFFIC NSW
              label: Website
              arrow: "mdi:arrow-top-right"
              action: url
              link: "https://www.livetraffic.com"
            view_layout:
              grid-column-start: 1
              grid-column-end: -1

          - type: custom:stack-in-card
            cards:
              - !include tamworth/snippets/livetraffic.yaml
              - !include tamworth/livetraffic/alpine.yaml
              - !include tamworth/livetraffic/fire.yaml
              - !include tamworth/livetraffic/flood.yaml
              - !include tamworth/livetraffic/incidents.yaml
              - !include tamworth/livetraffic/incidentslga.yaml
              - !include tamworth/livetraffic/majorevents.yaml
              - !include tamworth/livetraffic/roadwork.yaml

      # [Column] Weather
      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card_no_link
            variables:
              name: AIR QUALITY
            view_layout:
              grid-column-start: 1
              grid-column-end: -1
          - type: custom:stack-in-card
            cards:
              - !include tamworth/snippets/aqi_nswdpe.yaml
              - !include tamworth/graph_nswaqi.yaml

          - type: custom:stack-in-card
            cards:
              - !include tamworth/snippets/aqi_waqi.yaml
              - !include tamworth/graph_waqi.yaml

      # [Column] Weather
      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card
            variables:
              name: WEATHER
              label: More
              arrow: "mdi:arrow-top-right"
              action: url
              link: https://weather.bom.gov.au/location/r67r4u3-east-tamworth
            view_layout:
              grid-column-start: 1
              grid-column-end: -1

          - type: "custom:bom-radar-card"
            frame_count: 25
            center_latitude: "-31.09"
            center_longitude: "150.93"
            marker_latitude: "-31.09"
            marker_longitude: "150.93"
            show_marker: true
            show_range: true
            show_zoom: true
            show_recenter: true
            show_playback: true
            extra_labels: true
            show_radar_coverage: true
            show_radar_location: true
            zoom_level: "8"

      # [Column] Weather
      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card
            variables:
              name: SUN, MOON & UV
              label: More
              arrow: "mdi:arrow-top-right"
              action: url
              link: https://weather.bom.gov.au/location/r67r4u3-east-tamworth
            view_layout:
              grid-column-start: 1
              grid-column-end: -1
          - type: custom:stack-in-card
            cards:
              - !include tamworth/snippets/sun_moon.yaml
              - type: custom:sun-card
                style: |
                  .sun-card-title {
                    display: none;
                  }
                showAzimuth: true
                showElevation: true
                timeFormat: 24h
                title: ""

          - type: custom:stack-in-card
            cards:
              - !include tamworth/snippets/uv.yaml
              - !include tamworth/graph_uvindex.yaml

      # # [Column] Fuel
      - type: "custom:layout-card"
        view_layout:
          grid-column: span 2
        layout_type: "custom:grid-layout"
        layout:
          grid-template-columns: "repeat(auto-fill, [col-start] minmax(50%, 1fr) [col-end])"
          grid-template-rows: auto
          margin: -1
          mediaquery:
            "(max-width: 760px)":
              grid-template-columns: "repeat(auto-fill, [col-start] minmax(100%, 1fr) [col-end])"
        cards:
          - type: "custom:button-card"
            template: header_card_no_link
            variables:
              name: FUEL WATCH
            view_layout:
              grid-column-start: 1
              grid-column-end: -1
          - !include tamworth/snippets/fuel_u98.yaml
          - !include tamworth/snippets/fuel_u95.yaml
          - !include tamworth/snippets/fuel_u91.yaml
          - !include tamworth/snippets/fuel_e10.yaml

      # [Column] Bird Watch
      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card_no_link
            variables:
              name: BIRD WATCH
            view_layout:
              grid-column-start: 1
              grid-column-end: -1
          - type: custom:stack-in-card
            cards:
              - type: entities
                style: |
                  #states {
                    padding-top: 0px !important;
                    padding-bottom: 0px !important;
                  }
                entities:
                  - type: custom:card-templater
                    entities:
                      - sensor.plane_overhead_detail
                    card:
                      type: entities
                      style: |
                        #states {
                          padding-top: 5px !important;
                          padding-bottom: 0px !important;
                          padding-left: 0px !important;
                          padding-right: 0px !important;
                        }
                      entities:
                        - entity: sensor.plane_overhead_detail
                          name_template: |
                            {{ state_attr("sensor.plane_overhead_detail", "aircraft_owner") }}
                          type: "custom:multiple-entity-row"
                          show_state: true
                          secondary_info:
                            name: "Aircraft:"
                            attribute: aircraft
              - type: horizontal-stack
                cards:
                  - type: vertical-stack
                    cards:
                      - type: entity
                        entity: sensor.plane_overhead_detail
                        attribute: origin_airport_code
                        name: Origin
                        style: |
                          ha-card .header {
                            padding-top: 0px; !important;
                          }
                          ha-card .info {
                            padding-bottom: 0px; !important;
                          }
                      - show_name: false
                        show_icon: false
                        show_state: true
                        type: glance
                        entities:
                          - entity: sensor.plane_overhead_detail_origin_airport
                            card_mod:
                              style: |
                                div {text-align: left;}
                        style: |
                          .entity {padding: 0 !important; margin: -16px 0}
                  - type: vertical-stack
                    cards:
                      - type: entity
                        entity: sensor.plane_overhead_detail
                        attribute: destination_airport_code
                        name: Destination
                        style: |
                          ha-card .header {
                            padding-top: 0px; !important;
                          }
                          ha-card .info {
                            padding-bottom: 0px; !important;
                          }
                      - show_name: false
                        show_icon: false
                        show_state: true
                        type: glance
                        entities:
                          - entity: sensor.plane_overhead_detail_dest_airport
                            card_mod:
                              style: |
                                div {text-align: left;}
                        style: |
                          .entity {padding: 0 !important; margin: -16px 0}

      - type: vertical-stack
        cards:
          - type: "custom:button-card"
            template: header_card_no_link
            variables:
              name: HOSPITAL
            view_layout:
              grid-column-start: 1
              grid-column-end: -1
          - type: vertical-stack
            cards:
              - !include tamworth/snippets/hospital.yaml

      - !include tamworth/dams.yaml
